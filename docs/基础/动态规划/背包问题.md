[toc]

## èƒŒåŒ…é—®é¢˜
èƒŒåŒ…é—®é¢˜ï¼šåˆ†æ•°èƒŒåŒ…(è´ªå¿ƒï¼‰ã€0-1èƒŒåŒ…ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰ã€å®Œå…¨/æ— é™èƒŒåŒ…ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰ã€‚

> åˆ†æ•°èƒŒåŒ…ï¼šè´ªå¿ƒç­–ç•¥ï¼Œé€‰é¢å•ä»·æœ€é«˜ã€‚

> 0-1èƒŒåŒ…ï¼šæ•´ä¸ªç‰©å“ã€‚ä¸Šä¸€è¡Œ

> å®Œå…¨èƒŒåŒ…ï¼šæ•´ä¸ª + æ— é™ç‰©å“ã€‚æœ¬è¡Œ

![alt text](https://cdn.jsdelivr.net/gh/sword4869/pic1@main/images/202408231645317.png)

## åˆ†æ•°èƒŒåŒ…ï¼ˆè´ªå¿ƒï¼‰
æŒ‰ç…§å•ä»·é€†åºã€‚

éå†è£…å…¥èƒŒåŒ…ï¼Œåˆ¤æ–­æ‹¿å®Œå’Œæ‹¿ä¸å®Œã€‚	

â€‹	æ‹¿å®Œå°±è£…å…¥ï¼Œå‡å°å®¹é‡ï¼›

â€‹	æ‹¿ä¸å®Œï¼Œå°±è£…å…¥éƒ¨åˆ†ï¼ŒæŠŠå‰©ä½™ç©ºé—´å¡«æ»¡ã€‚

```java
/* ç‰©å“ */
class Item {
    int w; // ç‰©å“é‡é‡
    int v; // ç‰©å“ä»·å€¼

    public Item(int w, int v) {
        this.w = w;
        this.v = v;
    }
}

/* åˆ†æ•°èƒŒåŒ…ï¼šè´ªå¿ƒ */
double fractionalKnapsack(Item[] items, int[] wgt, int[] val, int cap) {
    // æŒ‰ç…§å•ä½ä»·å€¼ item.v / item.w ä»é«˜åˆ°ä½è¿›è¡Œæ’åº
    Arrays.sort(items, Comparator.comparingDouble(item -> -((double) item.v / item.w)));
    // å¾ªç¯è´ªå¿ƒé€‰æ‹©
    double res = 0;
    for (Item item : items) {
        if (item.w <= cap) {
            // è‹¥å‰©ä½™å®¹é‡å……è¶³ï¼Œåˆ™å°†å½“å‰ç‰©å“æ•´ä¸ªè£…è¿›èƒŒåŒ…
            res += item.v;
            cap -= item.w;
        } else {
            // è‹¥å‰©ä½™å®¹é‡ä¸è¶³ï¼Œåˆ™å°†å½“å‰ç‰©å“çš„ä¸€éƒ¨åˆ†è£…è¿›èƒŒåŒ…
            res += (double) item.v / item.w * cap;
            // å·²æ— å‰©ä½™å®¹é‡ï¼Œå› æ­¤è·³å‡ºå¾ªç¯
            break;
        }
    }
    return res;
}
```



## 01èƒŒåŒ…ï¼šæœ€å¤§ä»·å€¼

ä¸éœ€è¦ç‰©å“ä»·å€¼æ’åºã€‚

`dp[ n æˆ– n + 1][cap + 1]`: éƒ½æ˜¯ **cap + 1**ã€‚å› ä¸º`c-w[i]`ä¼šç­‰äº0ï¼Œå°±éœ€è¦cap=0çš„æƒ…å†µ

![image-20240812231037699](https://cdn.jsdelivr.net/gh/sword4869/pic1@main/images/202408122310736.png)

### n x (cap+1)

å¯¹ç€æ¯ä¸ªç‰©å“ï¼Œè¿›è¡Œ**[0, æœ€å¤§èƒŒåŒ…å®¹é‡]**çš„ä¾æ¬¡è®¡ç®—ã€‚å¾—åˆ° n x (cap+1) çš„æ•°ç»„ã€‚

`dp[i][c]`è¡¨ç¤ºå‰`[0...i]`ä¸ªç‰©å“ä¸€èµ·è€ƒè™‘åå¯¹åº”çš„ä¸åŒå®¹é‡èƒŒåŒ…`[0...cap]`ä¸‹çš„æœ€å¤§ä»·å€¼ã€‚



è¾¹ç•Œæ¡ä»¶ `åˆ—é¦–dp[x][0]=0ï¼Œé¦–è¡Œdp[0][x]=0||v[0]`



é€’æ¨å…¬å¼ 

$dp[i][c] =  \begin{cases}  dp[i-1][c], & \text{if } c < w[i] \\ \max(dp[i-1][c], dp[i-1][c - w[i]] + v[i]), & \text{if } c \geq w[i] \end{cases}$



æœ€ç»ˆè¿”å›çš„æ˜¯`dp[n-1][cap]`ï¼ˆä¸æ˜¯`[cap-1]`ï¼‰

â€‹	ç‰©å“å¯ä»¥ä»0å¼€å§‹ï¼Œ[0, n-1]ï¼›

â€‹	èƒŒåŒ…å¿…é¡»åŒ…å«0å’Œnï¼Œ0è¡¨ç¤ºæ²¡è£…ä¸œè¥¿ï¼Œnè¡¨ç¤ºæœ€å¤§å®¹é‡ã€‚


```java
/* 0-1 èƒŒåŒ…ï¼šåŠ¨æ€è§„åˆ’ */
public int pack01(int[] w, int[] v, int n, int cap) {
    int[][] dp = new int[n][cap + 1];
    // åˆ—é¦–ç©ºï¼šå½“èƒŒåŒ…å®¹é‡ä¸º0æ—¶ï¼Œæœ€å¤§ä»·å€¼æ˜¯0
    // for (int i = 0; i < n; i++) {
    //    dp[i][0] = 0;
    // }
    // é¦–è¡Œ
    for (int c = 0; c <= cap; c++) {
        if (c >= w[0]) {
            dp[0][c] = v[0];
        }
    }
    // ä»ç¬¬äºŒä¸ªç‰©å“å¼€å§‹
    for (int i = 1; i < n; i++) {
        for (int c = 1; c <= cap; c++) {
            if (c >= w[i]) {
                // è£…çš„ä¸‹ï¼šä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼
                dp[i][c] = Math.max(dp[i - 1][c], dp[i - 1][c - w[i]] + v[i]);
            } else{
	            // è£…ä¸ä¸‹ï¼šåˆ™ä¸é€‰ç‰©å“ i
                dp[i][c] = dp[i - 1][c];
            }
        }
    }
    return dp[n - 1][cap];
}

/* 0-1 èƒŒåŒ…ï¼šç©ºé—´ä¼˜åŒ–åçš„åŠ¨æ€è§„åˆ’ */
public int pack01(int[] w, int[] v, int n, int cap) {
    int[] dp = new int[cap + 1];
    // åˆ—é¦–ç©º dp[0] = 0;
    // é¦–è¡Œ
    for (int c = 0; c <= cap; c++) {
        if (c >= w[0]) {
            dp[c] = v[0];
        }
    }
    for (int i = 1; i < n; i++) {
        for (int c = cap; c >= 0; c--) {
	        // å€’åºéå†!!!!! å› ä¸ºæ­£åºä¿®æ”¹åé¢ä¾èµ–çš„ä¸Šè¡Œå†å²æ•°æ®ï¼Œå˜æˆäº†æœ¬è¡Œçš„æœ€æ–°æ•°æ®
            // è£…ä¸ä¸‹ï¼šåˆ™ä¸å˜
            // è£…çš„ä¸‹ï¼šä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼
            if (c >= w[i]) {
	            dp[c] = Math.max(dp[c], dp[c - w[i]] + v[i]);
            }
        }
    }
    return dp[cap];
}
```

### ğŸš€(n+1) x (cap+1) æ¨è

å¯¹ç€æ¯ä¸ªç‰©å“ï¼ˆåŒ…æ‹¬0ä¸ªç‰©å“ï¼‰ï¼Œè¿›è¡Œ[0, æœ€å¤§èƒŒåŒ…å®¹é‡]çš„ä¾æ¬¡è®¡ç®—ã€‚å¾—åˆ° (n+1) x (cap+1) çš„æ•°ç»„ã€‚

`dp[i][c]`è¡¨ç¤ºå‰iä¸ªç‰©å“ï¼ˆ`w[0...i-1]`ï¼‰ä¸€èµ·è€ƒè™‘åå¯¹åº”çš„ä¸åŒå®¹é‡èƒŒåŒ…`[0...cap]`ä¸‹çš„æœ€å¤§ä»·å€¼ã€‚



è¾¹ç•Œæ¡ä»¶ 

è®©ç¬¬ä¸€ä¸ªç‰©å“æ˜¯`0||v[0]`ï¼Œè®©å…¶å½’å…¥åˆ°é€’æ¨å…¬å¼ä¸­ï¼Œåˆ™`åˆ—é¦–dp[x][0]=0ï¼Œé¦–è¡Œdp[0][x]=0`ï¼ˆåˆšå¥½éƒ½æ˜¯é»˜è®¤0ï¼‰



é€’æ¨å…¬å¼ ï¼ˆåˆ¤æ–­å’Œå…¬å¼ä¸­çš„wå’Œvæ˜¯i-1ï¼‰

$$
dp[i][c] =  \begin{cases}  dp[i-1][c], & \text{if } c < w[i-1]\\ \max(dp[i-1][c], dp[i-1][c - w[i-1]] + v[i-1]), & \text{if } c \geq w[i-1] \end{cases}
$$



æœ€ç»ˆè¿”å›çš„æ˜¯`dp[n][cap]`ï¼ˆä¸æ˜¯`[n-1]`ï¼‰

â€‹	å®é™…ç‰©å“å¯ä»¥ä»1å¼€å§‹ï¼Œ[1, n]ï¼›

â€‹	èƒŒåŒ…å¿…é¡»åŒ…å«0å’Œnï¼Œ0è¡¨ç¤ºæ²¡è£…ä¸œè¥¿ï¼Œnè¡¨ç¤ºæœ€å¤§å®¹é‡ã€‚

```java
public int pack01(int[] w, int[] v, int cap) {
    int n = w.length;
    int[][] dp = new int[n + 1][cap + 1];	// n + 1ä¸ªç‰©å“ï¼Œcap+1ä¸ªå®¹é‡ã€dpçš„èŒƒå›´æ˜¯èƒŒåŒ…çš„æœ€å¤§å®¹é‡ã€‘
    // ã€ä¸¤ä¸ªå¾ªç¯ï¼šä¸€ä¸ªéå†ç‰©å“ï¼Œä¸€ä¸ªéå†èƒŒåŒ…å¤§å°ã€‘
    for (int i = 1; i <= n; i++) {		// ä»ç¬¬1ä¸ªç‰©å“å¼€å§‹ï¼ŒåŒ…æ‹¬n
        for (int c = 1; c <= cap; c++) {
            if (c >= w[i-1]) {
                // è£…çš„ä¸‹ï¼šä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼
                dp[i][c] = Math.max(dp[i - 1][c], dp[i - 1][c - w[i-1]] + v[i-1]);
            } else{  
	            // è£…ä¸ä¸‹ï¼šåˆ™ä¸é€‰ç‰©å“ i
                dp[i][c] = dp[i - 1][c];
            }
        }
    }
    return dp[n][cap];
}

/* 0-1 èƒŒåŒ…ï¼šç©ºé—´ä¼˜åŒ–åçš„åŠ¨æ€è§„åˆ’ */
public int pack01(int[] w, int[] v, int n, int cap) {
    int[] dp = new int[cap + 1];		// dpçš„èŒƒå›´æ˜¯èƒŒåŒ…çš„æœ€å¤§å®¹é‡
    // ã€ä¸¤ä¸ªå¾ªç¯ï¼šä¸€ä¸ªéå†ç‰©å“ï¼Œä¸€ä¸ªã€å€’åºã€‘éå†èƒŒåŒ…å¤§å°ã€‘
    for (int i = 1; i <= n; i++) {
        for (int c = cap; c >= w[i-1]; c--) {		// æŠŠifåˆ¤æ–­èåˆè¿›å»ï¼šèƒŒç™½è£…ä¸ä¸‹çš„ï¼Œå°±ä¸å˜
            dp[c] = Math.max(dp[c], dp[c - w[i-1]] + v[i-1]);
        }
    }
    return dp[cap];
}
```



### ç»ƒä¹ 

 [æ´›è°·P1048 é‡‡è¯.md](..\..\é¢˜\å…¶ä»–\æ´›è°·P1048 é‡‡è¯.md) 

 [æ´›è°·P1049 è£…ç®±é—®é¢˜.md](..\..\é¢˜\å…¶ä»–\æ´›è°·P1049 è£…ç®±é—®é¢˜.md) 

## 01èƒŒåŒ…ï¼šåˆšå¥½ä»·å€¼çš„æ–¹æ¡ˆ

```java
public int pack01(int[] w, int cap) {
    int n = w.length;
    int[] dp = new int[cap + 1];
    for (int i = 1; i <= n; i++) {
        for (int c = cap; c >= 0; c--) {
            // æ²¡é’±ï¼Œåˆ™åŒå†å²æ–¹æ¡ˆæ•°
            if( c < w[i-1]){
                // åˆ™ä¸å˜
            }
            // åˆšå¥½ï¼Œé‚£å°±å†å¤šä¸€ä¸ªåªåƒå®ƒçš„æ–¹æ¡ˆ
            else if (c == w[i-1]) {
                dp[c] = dp[c] + 1;
            }
            // è¶…é¢ï¼Œé‚£ä¹ˆå¤šçš„æ˜¯ dp[c - w[i-1]] è¡¨ç¤ºåƒï¼ˆå®ƒï¼Œå…¶ä»–ï¼‰çš„å¥—é¤ã€‚
            else{
                dp[c] = dp[c] + dp[c - w[i-1]];
            }
        }
    }
    return dp[cap];
}
```

 [æ´›è°·P1164 å°Aç‚¹èœ.md](..\..\é¢˜\å…¶ä»–\æ´›è°·P1164 å°Aç‚¹èœ.md) 

## å®Œå…¨èƒŒåŒ…

**æ¯ä¸ªç‰©å“å¯ä»¥é‡å¤é€‰å–**ï¼Œæ‰€ä»¥çœ‹çš„æ˜¯æœ¬è¡Œçš„æœ€å¤§ä»·å€¼ï¼ˆæœ€æ–°çš„ï¼‰

![image-20240813084127881](https://cdn.jsdelivr.net/gh/sword4869/pic1@main/images/202408130841883.png)



### n x (cap+1)

$$
dp[i, c] = \max(dp[i-1, c], dp[i, c - w[i]] + v[i])%
$$

```java
/* å®Œå…¨èƒŒåŒ…ï¼šåŠ¨æ€è§„åˆ’ */
public long packInfinity(int[] w, int[] v, int n, int cap) {
    long[][] dp = new long[n][cap + 1];
    // åˆ—é¦–æ˜¯0ï¼Œä½¿ç”¨é»˜è®¤
    // ç¬¬ä¸€è¡Œ
    for (int c = 1; c <= cap; c++) {
        if (w[0] <= c) {
            dp[0][c] = dp[0][c - w[0]] + v[0];
        }
    }
    for (int i = 1; i < n; i++) {
        for (int c = 1; c <= cap; c++) {
	        if (w[0] <= c) {            
                // è£…çš„ä¸‹ï¼šä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼
                dp[i][c] = Math.max(dp[i - 1][c], dp[i][c - w[i]] + v[i]);
            } else {
                dp[i][c] = dp[i - 1][c];
            }
        }
    }
    return dp[n - 1][cap];
}

/* å› ä¸ºéƒ½æ˜¯åŒä¸€è¡Œï¼Œæ‰€ä»¥æ—¢ä¸éœ€è¦å€’åºï¼Œè€Œä¸”ä¹Ÿä¸éœ€è¦åˆå§‹åŒ–ç¬¬ä¸€è¡Œã€‚ */
public long packInfinity(int[] w, int[] v, int n, int cap) {
    long[] dp = new long[cap + 1];
    // åˆ—é¦–æ˜¯0ï¼Œä½¿ç”¨é»˜è®¤
    for (int i = 0; i < n; i++) {
        for (int c = 1; c <= cap; c++) {
            // è£…ä¸ä¸‹å°±ç»´æŒä¸å˜
            if (w[i] <= c) {
                // è£…çš„ä¸‹ï¼šä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼
                dp[c] = Math.max(dp[c], dp[c - w[i]] + v[i]);
            }
        }
    }
    return dp[cap];
}
```



### ğŸš€(n+1) x (cap+1)

$$
dp[i, c] = \max(dp[i-1, c], dp[i, c - w[i-1]] + v[i-1])
$$



```java
public long packInfinity(int[] w, int[] v, int n, int cap) {
    long[][] dp = new long[n + 1][cap + 1];
    for (int i = 1; i <= n; i++) {
        for (int c = 1; c <= cap; c++) {
	        if (c >= w[i-1]) {            
                // è£…çš„ä¸‹ï¼šä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼
                dp[i][c] = Math.max(dp[i - 1][c], dp[i][c - w[i-1]] + v[i-1]);
            } else {
                dp[i][c] = dp[i - 1][c];
            }
        }
    }
    return dp[n][cap];
}

public long packInfinity(int[] w, int[] v, int n, int cap) {
    long[] dp = new long[cap + 1];
    // ã€æ­£åºã€‘éå†èƒŒåŒ…
    for (int i = 1; i <= n; i++) {
        for (int c = w[i-1]; c <= cap; c++) {		// æŠŠifåˆ¤æ–­çš„å°äºåˆ™ä¿æŒä¸å˜ï¼Œèåˆè¿›å»
            dp[c] = Math.max(dp[c], dp[c - w[i-1]] + v[i-1]);
        }
    }
    return dp[cap];
}
```

### ç»ƒä¹ 

 [æ´›è°·P1616 ç–¯ç‹‚çš„é‡‡è¯.md](..\..\é¢˜\å…¶ä»–\æ´›è°·P1616 ç–¯ç‹‚çš„é‡‡è¯.md) 

 [æ´›è°·P1853 æŠ•èµ„çš„æœ€å¤§æ•ˆç›Š.md](..\..\é¢˜\å…¶ä»–\æ´›è°·P1853 æŠ•èµ„çš„æœ€å¤§æ•ˆç›Š.md)  

ã€æ¨¡æ¿ã€‘ [322. é›¶é’±å…‘æ¢.md](..\..\é¢˜\leetcode\322. é›¶é’±å…‘æ¢.md) : æœ€å°æ±‚è§£ã€åˆšå¥½

ã€æ¨¡æ¿ã€‘[æ´›è°·P2918 USACO08NOV Buying Hay S.md](..\..\é¢˜\å…¶ä»–\æ´›è°·P2918 USACO08NOV Buying Hay S.md) : æœ€å°æ±‚è§£ã€è‡³å°‘

ã€æ¨¡æ¿ã€‘ [518. é›¶é’±å…‘æ¢ II.md](..\..\é¢˜\leetcode\518. é›¶é’±å…‘æ¢ II.md) åˆšå¥½ä»·å€¼çš„æ–¹æ¡ˆ

## Todo

[èƒŒåŒ…é—®é¢˜ - é¢˜å• - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)](https://www.luogu.com.cn/training/5197)

